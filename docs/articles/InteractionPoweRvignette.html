<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="This article describes how to use InteractionPoweR and also explains how the functions underlying this package work.">
<title>The InteractionPoweR Package • InteractionPoweR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The InteractionPoweR Package">
<meta property="og:description" content="This article describes how to use InteractionPoweR and also explains how the functions underlying this package work.">
<meta property="og:image" content="https://dbaranger.github.io/InteractionPoweR/logo.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@David_Baranger">
<meta name="twitter:site" content="@David_Baranger">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-36JVDTC1K0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-36JVDTC1K0');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">InteractionPoweR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/InteractionPoweRvignette.html">The InteractionPoweR Package</a>
    <a class="dropdown-item" href="../articles/InteractionPower2waycovsvignette.html">Interaction Power: Power analyses for 2-way interactions with covariates</a>
    <a class="dropdown-item" href="../articles/InteractionPoweR3wayvignette.html">Interaction Power: Power analyses for 3-way interactions</a>
    <a class="dropdown-item" href="../articles/InteractionPoweR_Stability.html">InteractionPoweR Stability Update</a>
    <a class="dropdown-item" href="../articles/CommonQuestions.html">Questions &amp; Errors</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dbaranger/InteractionPoweR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>The InteractionPoweR Package</h1>
                        <h4 data-toc-skip class="author">David AA
Baranger</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dbaranger/InteractionPoweR/blob/HEAD/vignettes/articles/InteractionPoweRvignette.Rmd" class="external-link"><code>vignettes/articles/InteractionPoweRvignette.Rmd</code></a></small>
      <div class="d-none name"><code>InteractionPoweRvignette.Rmd</code></div>
    </div>

    
    
<p>This vignette describes the basics of interaction analyses and how to
use this package. A more updated version of our discussion of many of
the topics listed here can be found in our tutorial paper (open access),
which can be found at: <a href="https://journals.sagepub.com/doi/full/10.1177/25152459231187531" class="external-link uri">https://journals.sagepub.com/doi/full/10.1177/25152459231187531</a></p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Interaction analyses take the form:</p>
<p><span class="math display">\[
Y \sim \beta_0 + X_1\beta_1 + X_2\beta_2 + X_1X_2\beta_3 + \epsilon
\]</span></p>
<p>Where <span class="math inline">\(Y\)</span> is the dependent
variable, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are our independent variables, and
our interaction term is <span class="math inline">\(X_1X_2\)</span>. The
<span class="math inline">\(\beta\)</span>s in this equation are our
regression coefficients and <span class="math inline">\(\epsilon\)</span> is our error. Note that in this
equation, and throughout the code in this package, we refer to the two
interacting variables as <span class="math inline">\(X_1\)</span> and
<span class="math inline">\(X_2\)</span>, as opposed to <span class="math inline">\(X\)</span> and <span class="math inline">\(Z\)</span>, or <span class="math inline">\(X\)</span> and <span class="math inline">\(M\)</span>. This is to emphasize that, as far as
these simulations are concerned, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are interchangeable, and any
conclusions about causality (i.e. “moderation”) will rely on the
specifics of the variables.</p>
<p>The goal of the power analyses supported by this package is to
determine how much power an analysis has to detect whether <span class="math inline">\(\beta_3\)</span> (the interaction term regression
coefficient) is different from 0 at some pre-specified <span class="math inline">\(\alpha\)</span> value (<code>alpha</code>, or
p-value). <span class="math inline">\(\alpha\)</span> refers to our
<em>false positive rate</em>, which is how frequently we will accept
that our analysis has incorrectly rejected the null hypothesis.
<strong>Power</strong>, refers to our <em>true positive rate</em>, how
frequently do we want to correctly accept the alternative hypothesis? It
may be easier to think about the inverse of power, the <em>false
negative rate</em>: how frequently will we incorrectly accept the null
hypothesis? A “typical” (though not necessarily recommended) value for
power is 0.8, which means that 20%, or <span class="math inline">\(1/5\)</span>, of the time, the analysis will
<em>incorrectly</em> conclude that there is no effect when there
actually is one. (We recommend striving for at least a power of .9)</p>
</div>
<div class="section level2">
<h2 id="effect-sizes">Effect sizes<a class="anchor" aria-label="anchor" href="#effect-sizes"></a>
</h2>
<p>Any simulation in this package requires at minimum 5 input
variables:</p>
<ol style="list-style-type: decimal">
<li>
<code>N</code>: the sample size.</li>
<li>
<code>r.x1.y</code>: the Pearson’s correlation (<span class="math inline">\(r\)</span>) between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y\)</span>
</li>
<li>
<code>r.x2.y</code>: the Pearson’s correlation (<span class="math inline">\(r\)</span>) between <span class="math inline">\(X_2\)</span> and <span class="math inline">\(Y\)</span>
</li>
<li>
<code>r.x1.x2</code>: the Pearson’s correlation (<span class="math inline">\(r\)</span>) between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>
</li>
<li>
<code>r.x1x2.y</code>: the Pearson’s correlation (<span class="math inline">\(r\)</span>) between <span class="math inline">\(X_1X_2\)</span> and <span class="math inline">\(Y\)</span> - this is the interaction effect</li>
</ol>
<p>It is important to emphasize here that inputs 2-5 are the
population-level <em>Pearson’s correlation</em> between each pair of
variables. This is true even if any or all of the variables in the
simulation are binary. These correlations are used to derive the
regression coefficients via path tracing rules. Also note that these
effect sizes are the <em>cross-sectional</em> correlation. This is in
contrast to how one specifies effects for experimental manipulations,
where the effects are the correlation in each of the experimental
conditions. The Pearson’s correlation is equivalent to the effect size
<span class="math inline">\(\beta\)</span> (i.e. in the regression <span class="math inline">\(Y \sim \beta_0 + X\beta + \epsilon\)</span>) when
both <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> are normalized (mean = 0, sd = 1). For
inputs 2-4, we imagine that it will be relatively straightforward for
most users to identify the appropriate values (i.e. by surveying the
literature and identifying large independent studies where the effects
have been reported). However, in the case of the interaction effect
size, <code>r.x1x2.y</code>, users may be less used to thinking about
interaction effects as correlations. The interaction effect size is the
how much the correlation between one of the two independent variables
and the dependent variable changes when <em>conditioned</em> on the
other independent variable. It is both how much <span class="math inline">\(corr(X_1,Y)\)</span> changes when conditioned on
<span class="math inline">\(X_2\)</span>, and equivalently how much
<span class="math inline">\(corr(X_2,Y)\)</span> changes when
conditioned on <span class="math inline">\(X_1\)</span>.</p>
<p>A common way of thinking about interaction effect sizes is to plot
the data as “simple slopes”. A simple slopes plot shows the correlation
between one of the independent variables (e.g. <span class="math inline">\(X_1\)</span>) and the dependent variable (<span class="math inline">\(Y\)</span>) in different subsets of the data,
where each subset is defined by their value at the second independent
variable (e.g. <span class="math inline">\(X_2\)</span>). For example,
we can plot <span class="math inline">\(Y \sim X_1\)</span> separately
in participants with an <span class="math inline">\(X_2\)</span> value
in the lower-half of the distribution and the upper-half of the
distribution.</p>
<div class="section level3">
<h3 id="simulating-single-data-sets">Simulating single data sets<a class="anchor" aria-label="anchor" href="#simulating-single-data-sets"></a>
</h3>
<p>To facilitate user’s understanding of interaction effect sizes,
<code>InteractionPoweR</code> includes functions for simulating single
data sets and plotting the interaction as a simple slopes plot:</p>
<p>The function <code><a href="../reference/generate_interaction.html">generate_interaction()</a></code> simulates a single
data set:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbaranger.github.io/InteractionPoweR/">InteractionPoweR</a></span><span class="op">)</span></span>
<span><span class="va">example_data</span> <span class="op">=</span> <span class="fu"><a href="../reference/generate_interaction.html">generate_interaction</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">350</span>,        <span class="co"># sample size</span></span>
<span>                                    r.x1.y <span class="op">=</span> <span class="fl">.2</span>,    <span class="co"># correlation between x1 and y</span></span>
<span>                                    r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,   <span class="co"># correlation between x2 and y</span></span>
<span>                                    r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,   <span class="co"># correlation between x1 and x2</span></span>
<span>                                    r.x1x2.y <span class="op">=</span> <span class="fl">.15</span>  <span class="co"># correlation between x1x2 and y</span></span>
<span>                                      <span class="op">)</span></span></code></pre></div>
<p>The data can then be plotted using the
<code><a href="../reference/plot_interaction.html">plot_interaction()</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_interaction.html">plot_interaction</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example_data</span>, <span class="co"># simulated data</span></span>
<span>                 q <span class="op">=</span> <span class="fl">2</span>                <span class="co"># number of simple slopes</span></span>
<span>                 <span class="op">)</span></span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig1-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The function <code><a href="../reference/test_interaction.html">test_interaction()</a></code> provides easy access to
the results of the interaction regression, the adjusted <span class="math inline">\(R^2\)</span> of the interaction term, the 95%
confidence interval of the interaction term, the shape of the
interaction (<code>crossover.point</code> = the value of <span class="math inline">\(X_1\)</span> where the <span class="math inline">\(X_2\)</span> simple-slopes intersect,
<code>shape</code> = the shape of the interaction, &gt;1 = cross-over, 1
= knock-out, &lt;1 = attenuated), the simple slopes of <span class="math inline">\(X_2\)</span>, and the correlation between the
variables:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/test_interaction.html">test_interaction</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example_data</span>, <span class="co"># simulated data</span></span>
<span>                 q <span class="op">=</span> <span class="fl">2</span>                <span class="co"># number of simple slopes</span></span>
<span>                 <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $linear.model</span></span>
<span><span class="co">##       Estimate Std. Error  t value     Pr(&gt;|t|)</span></span>
<span><span class="co">## x1   0.1888967 0.05153863 3.665148 2.859696e-04</span></span>
<span><span class="co">## x2   0.1356407 0.05165265 2.626016 9.022851e-03</span></span>
<span><span class="co">## x1x2 0.2129386 0.05001033 4.257892 2.661829e-05</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="a-simple-power-analysis">A simple power analysis<a class="anchor" aria-label="anchor" href="#a-simple-power-analysis"></a>
</h2>
<p>The simplest power analysis we can run is one in which all the
parameters are already known. All the correlations are known, the sample
size is known, and the interaction effect size is known. We additionally
specify <code>alpha</code>, which is the p-value we’re using (0.05 is
default). We can compute power analytically using the
<code><a href="../reference/power_interaction_r2.html">power_interaction_r2()</a></code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/power_interaction_r2.html">power_interaction_r2</a></span><span class="op">(</span></span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,   <span class="co"># p-value</span></span>
<span>                  N <span class="op">=</span> <span class="fl">350</span>,        <span class="co"># sample size</span></span>
<span>                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,    <span class="co"># correlation between x1 and y</span></span>
<span>                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,   <span class="co"># correlation between x2 and y</span></span>
<span>                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,   <span class="co"># correlation between x1 and x2</span></span>
<span>                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span> <span class="co"># correlation between x1x2 and y</span></span></code></pre></div>
<pre><code><span><span class="co">##         pwr</span></span>
<span><span class="co">## 1 0.8131373</span></span></code></pre>
<p>We find that our analysis has 80% power (<code>pwr</code>), and the
interaction has a shape of 0.75 (the interaction effect
<code>x1x2</code> is 75% of the magnitude of <code>x1</code> - the
interaction is an attenuated effect where the simple-slope lines are all
in the same direction).</p>
<p>We can also use the function <code>power_interaction</code> to
compute power via monte-carlo simulation. Additional parameters include
<code>n.iter</code>, which is the number of simulations run. In this
example we’ll use just 1,000 simulations, but we recommend using 10,000
for more stable results.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">290115</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">1000</span>,  <span class="co"># number of simulations</span></span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,   <span class="co"># p-value</span></span>
<span>                  N <span class="op">=</span> <span class="fl">350</span>,        <span class="co"># sample size</span></span>
<span>                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,    <span class="co"># correlation between x1 and y</span></span>
<span>                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,   <span class="co"># correlation between x2 and y</span></span>
<span>                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,   <span class="co"># correlation between x1 and x2</span></span>
<span>                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span> <span class="co"># correlation between x1x2 and y</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: executing %dopar% sequentially: no parallel backend registered</span></span></code></pre>
<pre><code><span><span class="co">##     N   pwr</span></span>
<span><span class="co">## 1 350 0.805</span></span></code></pre>
<p>We find that our analysis has 80% power (<code>pwr</code>).</p>
</div>
<div class="section level2">
<h2 id="exploring-the-parameter-space">Exploring the parameter space<a class="anchor" aria-label="anchor" href="#exploring-the-parameter-space"></a>
</h2>
<p>Typically not all variables are known in a power analysis. For
example, we know the magnitude of the interaction effect we’re
interested in, and we want to learn what sample size would be needed to
detect that effect with 90% power. Or we have a sample already, and we
want to learn what is the smallest effect we can detect with 90% power.
To answer these questions, the user simply needs to provide the range of
parameters that they would like the analysis to use. Almost any of the
input parameters can be ranges, and the <code>power_interaction</code>
runs <code>n.iter</code> simulations for every combination of input
parameters.</p>
<p>As the number of input parameters increase, so too does the total
number of simulations. To reduce the amount of time an analysis takes,
<code><a href="../reference/power_interaction.html">power_interaction()</a></code> supports running simulations in
parallel. The number of cores to be used for the parallel simulation is
indicated by the <code>cl</code> flag (we recommend a number between 4 -
6 on most personal computers).</p>
<div class="section level3">
<h3 id="finding-the-optimal-sample-size">Finding the optimal sample size<a class="anchor" aria-label="anchor" href="#finding-the-optimal-sample-size"></a>
</h3>
<p>For example, to explore multiple sample sizes we can set
<code>N = seq(200,600,by = 50)</code>, which runs a simulation for N =
200, 250, 300 etc, up to N=500. Equivalently, we could also set
<code>N  = c(200,250,300,350,400,450,500,550,600)</code>, but the former
is faster to write.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction_r2.html">power_interaction_r2</a></span><span class="op">(</span></span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                  <span class="co"># p-value</span></span>
<span>                  N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">600</span>,by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,      <span class="co"># sample size</span></span>
<span>                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and y</span></span>
<span>                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,                  <span class="co"># correlation between x2 and y</span></span>
<span>                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                  <span class="co"># correlation between x1 and x2</span></span>
<span>                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span>                <span class="co"># correlation between x1x2 and y</span></span>
<span>                 </span>
<span><span class="va">power_test</span></span></code></pre></div>
<pre><code><span><span class="co">##      N       pwr</span></span>
<span><span class="co">## 1  200 0.5724275</span></span>
<span><span class="co">## 2  210 0.5935829</span></span>
<span><span class="co">## 3  220 0.6139697</span></span>
<span><span class="co">## 4  230 0.6335895</span></span>
<span><span class="co">## 5  240 0.6524470</span></span>
<span><span class="co">## 6  250 0.6705498</span></span>
<span><span class="co">## 7  260 0.6879081</span></span>
<span><span class="co">## 8  270 0.7045340</span></span>
<span><span class="co">## 9  280 0.7204417</span></span>
<span><span class="co">## 10 290 0.7356468</span></span>
<span><span class="co">## 11 300 0.7501662</span></span>
<span><span class="co">## 12 310 0.7640182</span></span>
<span><span class="co">## 13 320 0.7772214</span></span>
<span><span class="co">## 14 330 0.7897955</span></span>
<span><span class="co">## 15 340 0.8017607</span></span>
<span><span class="co">## 16 350 0.8131373</span></span>
<span><span class="co">## 17 360 0.8239461</span></span>
<span><span class="co">## 18 370 0.8342077</span></span>
<span><span class="co">## 19 380 0.8439429</span></span>
<span><span class="co">## 20 390 0.8531723</span></span>
<span><span class="co">## 21 400 0.8619163</span></span>
<span><span class="co">## 22 410 0.8701952</span></span>
<span><span class="co">## 23 420 0.8780286</span></span>
<span><span class="co">## 24 430 0.8854362</span></span>
<span><span class="co">## 25 440 0.8924369</span></span>
<span><span class="co">## 26 450 0.8990493</span></span>
<span><span class="co">## 27 460 0.9052915</span></span>
<span><span class="co">## 28 470 0.9111809</span></span>
<span><span class="co">## 29 480 0.9167346</span></span>
<span><span class="co">## 30 490 0.9219691</span></span>
<span><span class="co">## 31 500 0.9269002</span></span>
<span><span class="co">## 32 510 0.9315434</span></span>
<span><span class="co">## 33 520 0.9359132</span></span>
<span><span class="co">## 34 530 0.9400240</span></span>
<span><span class="co">## 35 540 0.9438894</span></span>
<span><span class="co">## 36 550 0.9475223</span></span>
<span><span class="co">## 37 560 0.9509354</span></span>
<span><span class="co">## 38 570 0.9541406</span></span>
<span><span class="co">## 39 580 0.9571493</span></span>
<span><span class="co">## 40 590 0.9599725</span></span>
<span><span class="co">## 41 600 0.9626206</span></span></code></pre>
<p>We can plot these results using the function
<code><a href="../reference/plot_power_curve.html">plot_power_curve()</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_power_curve.html">plot_power_curve</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span>, <span class="co"># output from power_interaction()</span></span>
<span>                 power_target <span class="op">=</span> <span class="fl">.9</span>,        <span class="co"># the power we want to achieve </span></span>
<span>                 x <span class="op">=</span> <span class="st">"N"</span> <span class="co"># x variable</span></span>
<span>                 <span class="op">)</span></span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig2-1.png" width="576" style="display: block; margin: auto;"></p>
<p>By eye-balling this plot, we can see that N=450 yields approximately
90% power, and N=330 yields approximately 80% power. Since it is so fast
to compute analytic power, we can re-run the analysis over a restricted
range to get the exact N.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction_r2.html">power_interaction_r2</a></span><span class="op">(</span></span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                  <span class="co"># p-value</span></span>
<span>                  N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">450</span>,<span class="fl">470</span>,by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,      <span class="co"># sample size</span></span>
<span>                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and y</span></span>
<span>                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,                  <span class="co"># correlation between x2 and y</span></span>
<span>                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                  <span class="co"># correlation between x1 and x2</span></span>
<span>                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span>                <span class="co"># correlation between x1x2 and y</span></span>
<span>                 </span>
<span><span class="va">power_test</span></span></code></pre></div>
<pre><code><span><span class="co">##      N       pwr</span></span>
<span><span class="co">## 1  450 0.8990493</span></span>
<span><span class="co">## 2  451 0.8996899</span></span>
<span><span class="co">## 3  452 0.9003268</span></span>
<span><span class="co">## 4  453 0.9009600</span></span>
<span><span class="co">## 5  454 0.9015896</span></span>
<span><span class="co">## 6  455 0.9022156</span></span>
<span><span class="co">## 7  456 0.9028379</span></span>
<span><span class="co">## 8  457 0.9034566</span></span>
<span><span class="co">## 9  458 0.9040718</span></span>
<span><span class="co">## 10 459 0.9046834</span></span>
<span><span class="co">## 11 460 0.9052915</span></span>
<span><span class="co">## 12 461 0.9058960</span></span>
<span><span class="co">## 13 462 0.9064970</span></span>
<span><span class="co">## 14 463 0.9070945</span></span>
<span><span class="co">## 15 464 0.9076886</span></span>
<span><span class="co">## 16 465 0.9082792</span></span>
<span><span class="co">## 17 466 0.9088663</span></span>
<span><span class="co">## 18 467 0.9094501</span></span>
<span><span class="co">## 19 468 0.9100304</span></span>
<span><span class="co">## 20 469 0.9106073</span></span>
<span><span class="co">## 21 470 0.9111809</span></span></code></pre>
<p>We achieve 90% power with N=460.</p>
<p>In the case where we are using simulations, running a lot of
simulations is computationally quite expensive. The function
<code><a href="../reference/power_estimate.html">power_estimate()</a></code> can thus be used to obtain a more precise
answer when we haven’t sampled the parameter space as densely. This
function fits a regression model to the power results to estimate when a
specific power will be achieved.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction_r2.html">power_interaction_r2</a></span><span class="op">(</span></span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                  <span class="co"># p-value</span></span>
<span>                  N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">600</span>,by <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,      <span class="co"># sample size</span></span>
<span>                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and y</span></span>
<span>                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,                  <span class="co"># correlation between x2 and y</span></span>
<span>                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                  <span class="co"># correlation between x1 and x2</span></span>
<span>                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span>                <span class="co"># correlation between x1x2 and y</span></span>
<span>                </span>
<span></span>
<span><span class="fu"><a href="../reference/power_estimate.html">power_estimate</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span>, <span class="co"># output from power_interaction()</span></span>
<span>                        x <span class="op">=</span> <span class="st">"N"</span>,        <span class="co"># the variable we want a precise number for</span></span>
<span>             power_target <span class="op">=</span> <span class="fl">0.9</span>         <span class="co"># the power we want to achieve </span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 445.3621</span></span></code></pre>
<p>With only 9 samples of the parameter space, we can estimate that we
nee N=453 to achieve 90% power, which isn’t that far off.</p>
</div>
<div class="section level3">
<h3 id="finding-the-smallest-detectable-effect-size">Finding the smallest detectable effect size<a class="anchor" aria-label="anchor" href="#finding-the-smallest-detectable-effect-size"></a>
</h3>
<p>Another common use-case is when the sample size and
variables-of-interest are known, and we want to know how small of an
interaction effect can be detected at a certain power level. We can
repeat the same steps as above, except this time <code>r.x1x2.y</code>
will be a range of values.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction_r2.html">power_interaction_r2</a></span><span class="op">(</span></span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                  <span class="co"># p-value</span></span>
<span>                  N <span class="op">=</span> <span class="fl">350</span>                ,       <span class="co"># sample size</span></span>
<span>                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and y</span></span>
<span>                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,                  <span class="co"># correlation between x2 and y</span></span>
<span>                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                  <span class="co"># correlation between x1 and x2</span></span>
<span>                  r.x1x2.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.2</span>,by<span class="op">=</span><span class="fl">.005</span><span class="op">)</span><span class="op">)</span>  <span class="co"># correlation between x1x2 and y</span></span>
<span>                  </span>
<span><span class="va">power_test</span></span></code></pre></div>
<pre><code><span><span class="co">##    r.x1x2.y       pwr</span></span>
<span><span class="co">## 1     0.100 0.4760123</span></span>
<span><span class="co">## 2     0.105 0.5138689</span></span>
<span><span class="co">## 3     0.110 0.5516069</span></span>
<span><span class="co">## 4     0.115 0.5888872</span></span>
<span><span class="co">## 5     0.120 0.6253837</span></span>
<span><span class="co">## 6     0.125 0.6607914</span></span>
<span><span class="co">## 7     0.130 0.6948340</span></span>
<span><span class="co">## 8     0.135 0.7272701</span></span>
<span><span class="co">## 9     0.140 0.7578978</span></span>
<span><span class="co">## 10    0.145 0.7865584</span></span>
<span><span class="co">## 11    0.150 0.8131373</span></span>
<span><span class="co">## 12    0.155 0.8375646</span></span>
<span><span class="co">## 13    0.160 0.8598129</span></span>
<span><span class="co">## 14    0.165 0.8798947</span></span>
<span><span class="co">## 15    0.170 0.8978583</span></span>
<span><span class="co">## 16    0.175 0.9137828</span></span>
<span><span class="co">## 17    0.180 0.9277732</span></span>
<span><span class="co">## 18    0.185 0.9399539</span></span>
<span><span class="co">## 19    0.190 0.9504639</span></span>
<span><span class="co">## 20    0.195 0.9594509</span></span>
<span><span class="co">## 21    0.200 0.9670667</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_power_curve.html">plot_power_curve</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span>, <span class="co"># output from power_interaction()</span></span>
<span>                 power_target <span class="op">=</span> <span class="fl">.9</span>        <span class="co"># the power we want to achieve </span></span>
<span>                 <span class="op">)</span></span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig3-1.png" width="576" style="display: block; margin: auto;"></p>
<p>We see that we have approximately 90% power to detect effects as
small as <code>r.x1x2.y</code> = 0.1725.</p>
<p>In some cases it may also be useful to take a look the distribution
of simple slopes across the range of parameters tested. If we run our
analysis as a simulation and use <code>detailed_results=T</code>, we can
look at the distribution of effect sizes and simple slopes.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">316834</span><span class="op">)</span></span>
<span><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">1000</span>,    <span class="co"># number of simulations</span></span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                  <span class="co"># p-value</span></span>
<span>                  N <span class="op">=</span> <span class="fl">350</span>                ,       <span class="co"># sample size</span></span>
<span>                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and y</span></span>
<span>                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,                  <span class="co"># correlation between x2 and y</span></span>
<span>                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                  <span class="co"># correlation between x1 and x2</span></span>
<span>                  r.x1x2.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.2</span>,by<span class="op">=</span><span class="fl">.01</span><span class="op">)</span>,   <span class="co"># correlation between x1x2 and y</span></span>
<span>                  cl <span class="op">=</span> <span class="fl">2</span>,                         <span class="co"># number of clusters for parallel analyses</span></span>
<span>                  detailed_results <span class="op">=</span> <span class="cn">T</span>           <span class="co"># detailed results</span></span>
<span>                <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Performing 11000 simulations</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_simple_slope.html">plot_simple_slope</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span><span class="op">)</span></span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig6-1.png" width="576" style="display: block; margin: auto;"></p>
<p>From this we can learn that the range of slopes that would be
consistent with the smallest effect we are powered to detect,
<code>r.x1x2.y</code>=0.17, is quite large. In particular, note that the
lower slope could be negative, 0, or even fairly large in the positive
direction - all consistent with <code>r.x1x2.y</code>=0.17. See the
section below on <strong>Detailed Results</strong> for more information
on all the outputs when <code>detailed.results = TRUE</code>.</p>
</div>
<div class="section level3">
<h3 id="varying-multiple-parameters">Varying multiple parameters<a class="anchor" aria-label="anchor" href="#varying-multiple-parameters"></a>
</h3>
<p>It is not uncommon that multiple parameters in the simulation are
unknown. To find the power at every combination of the parameters,
simply input a range of values for every unknown parameter in the
simulation. We generally recommend to only vary up to 3 parameters at a
time, any more and it can be difficult to parse the results (and
simulations can take a <em>very</em> long time to run). For example,
lets say there’s a range of plausible effect sizes for the interaction,
and we want to know how large of a sample we would need to detect each
of them. To test this, we can vary both <code>N</code> and
<code>r.x1x2.y</code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction_r2.html">power_interaction_r2</a></span><span class="op">(</span></span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                   <span class="co"># p-value</span></span>
<span>                  N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">600</span>,by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,       <span class="co"># sample size</span></span>
<span>                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                    <span class="co"># correlation between x1 and y</span></span>
<span>                  r.x2.y <span class="op">=</span> <span class="fl">.1</span>,                    <span class="co"># correlation between x2 and y</span></span>
<span>                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>       ,            <span class="co"># correlation between x1 and x2</span></span>
<span>                  r.x1x2.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.15</span>,<span class="fl">.2</span>,by<span class="op">=</span><span class="fl">.005</span><span class="op">)</span>, <span class="co"># correlation between x1x2 and y</span></span>
<span>                  detailed_results <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_power_curve.html">plot_power_curve</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span>, <span class="co"># output from power_interaction()</span></span>
<span>                 power_target <span class="op">=</span> <span class="fl">.9</span>,       <span class="co"># the power we want to achieve </span></span>
<span>                 x <span class="op">=</span> <span class="st">"N"</span>,                 <span class="co"># x-axis</span></span>
<span>                 group <span class="op">=</span> <span class="st">"r.x1x2.y"</span>       <span class="co"># grouping variable</span></span>
<span>                 <span class="op">)</span></span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig4-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/power_estimate.html">power_estimate</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N"</span>,<span class="st">"r.x1x2.y"</span>,<span class="st">"pwr"</span><span class="op">)</span><span class="op">)</span>, <span class="co"># select the variables used for the estimate</span></span>
<span>                        x <span class="op">=</span> <span class="st">"N"</span>,        <span class="co"># the variable we want a precise number for</span></span>
<span>             power_target <span class="op">=</span> <span class="fl">0.9</span>         <span class="co"># the power we want to achieve </span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    r.x1x2.y estimate</span></span>
<span><span class="co">## 1     0.150 440.7966</span></span>
<span><span class="co">## 2     0.155 412.6445</span></span>
<span><span class="co">## 3     0.160 387.7582</span></span>
<span><span class="co">## 4     0.165 365.0462</span></span>
<span><span class="co">## 5     0.170 344.5132</span></span>
<span><span class="co">## 6     0.175 325.8309</span></span>
<span><span class="co">## 7     0.180 308.7349</span></span>
<span><span class="co">## 8     0.185 293.3426</span></span>
<span><span class="co">## 9     0.190 278.8560</span></span>
<span><span class="co">## 10    0.195 265.4087</span></span>
<span><span class="co">## 11    0.200 253.3799</span></span></code></pre>
<p>From this we’ve learned that, depending on exactly what effect size
we’re aiming for, we’ll need an <code>N</code> between 260 and 450.</p>
</div>
<div class="section level3">
<h3 id="why-correlations-are-important">Why correlations are important<a class="anchor" aria-label="anchor" href="#why-correlations-are-important"></a>
</h3>
<p>Users may wonder why this package requires so many effect sizes and
correlations. Here is a simple example, where the magnitude of the
correlation between <code>x1</code> and <code>x2</code>, as well as
their main effects, jointly influence power, in somewhat surprising
ways.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction_r2.html">power_interaction_r2</a></span><span class="op">(</span></span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                   <span class="co"># p-value</span></span>
<span>                  N <span class="op">=</span> <span class="fl">600</span>,                       <span class="co"># sample size</span></span>
<span>                  r.x1.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.3</span>,<span class="fl">0</span>,<span class="fl">.3</span><span class="op">)</span>,                    <span class="co"># correlation between x1 and y</span></span>
<span>                  r.x2.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.3</span>,<span class="fl">.3</span>,<span class="fl">.05</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,                    <span class="co"># correlation between x2 and y</span></span>
<span>                  r.x1.x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.8</span>,<span class="fl">.8</span>,<span class="fl">.05</span><span class="op">)</span>,        <span class="co"># correlation between x1 and x2</span></span>
<span>                  r.x1x2.y <span class="op">=</span> <span class="fl">.1</span>,                  <span class="co"># correlation between x1x2 and y</span></span>
<span>                  detailed_results <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_power_curve.html">plot_power_curve</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span>, <span class="co"># output from power_interaction()</span></span>
<span>                 power_target <span class="op">=</span> <span class="fl">.8</span>,       <span class="co"># the power we want to achieve </span></span>
<span>                 x <span class="op">=</span> <span class="st">"r.x1.x2"</span>,</span>
<span>                 group <span class="op">=</span> <span class="st">"r.x2.y"</span>,</span>
<span>                 facets <span class="op">=</span>  <span class="st">"r.x1.y"</span>          </span>
<span>                 <span class="op">)</span></span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig4b-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Each line shows how power varies depending on the correlation between
<code>x1</code> and <code>x2</code>. This effect then also depends on
the main effects of <code>x1</code> and <code>x2</code>. Thus, ignoring
correlations could result in a very inaccurate power calculation.</p>
</div>
</div>
<div class="section level2">
<h2 id="reliability">Reliability<a class="anchor" aria-label="anchor" href="#reliability"></a>
</h2>
<p>Reliability is an important issue in statistics. Even if effects are
large, if your measurements are unreliable, then you’ll be
under-powered. This is especially true for interactions, as the
reliability of both <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> influence power, as well as the
reliability of <span class="math inline">\(Y\)</span>. In the context of
<code>InteractionPoweR</code>, “reliability” means the proportion of the
variance of each variable that is attributable to true signal, as
opposed to measurement error. A reliability of ‘1’ (the default), means
that your variables were measured with no error (reliability must be
greater than 0, and less than or equal to 1). Common statistics that
reflect reliability include test-retest reliability, inter-rater
reliability, and Cronbach’s alpha. The flags <code>rel.x1</code>,
<code>rel.x2</code>, and <code>rel.y</code> control the reliability of
each simulated variable. We recommend exploring how much reliability
will affect your power. For example:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction_r2.html">power_interaction_r2</a></span><span class="op">(</span></span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                   <span class="co"># p-value</span></span>
<span>                  N <span class="op">=</span> <span class="fl">450</span>,                        <span class="co"># sample size</span></span>
<span>                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                    <span class="co"># correlation between x1 and y</span></span>
<span>                  r.x2.y <span class="op">=</span> <span class="fl">.1</span>,                    <span class="co"># correlation between x2 and y</span></span>
<span>                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and x2</span></span>
<span>                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span>,                 <span class="co"># correlation between x1x2 and y</span></span>
<span>                  rel.x1 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.2</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">.1</span><span class="op">)</span>,      <span class="co"># x1 reliability    </span></span>
<span>                  rel.x2 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.2</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">.1</span><span class="op">)</span>,      <span class="co"># x2 reliability          </span></span>
<span>                  rel.y  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.2</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">.2</span><span class="op">)</span><span class="op">)</span>      <span class="co"># y reliability          </span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_power_curve.html">plot_power_curve</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span>, <span class="co"># output from power_interaction()</span></span>
<span>                 power_target <span class="op">=</span> <span class="fl">.9</span>,       <span class="co"># the power we want to achieve </span></span>
<span>                 x     <span class="op">=</span> <span class="st">"rel.x1"</span>,        <span class="co"># x-axis</span></span>
<span>                 group <span class="op">=</span> <span class="st">"rel.x2"</span>,        <span class="co"># grouping variable</span></span>
<span>                 facets<span class="op">=</span> <span class="st">"rel.y"</span>          <span class="co"># facets variable</span></span>
<span>                 <span class="op">)</span></span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig5-1.png" width="576" style="display: block; margin: auto;"></p>
<p>These plots make it clear how large of an effect reliability will
have on your results. In this simulation, even a reliability of
“acceptable” or “good” (reliability = 0.8), is enough to bring our power
down, from 0.9 to 0.636!</p>
</div>
<div class="section level2">
<h2 id="binaryordinal-variables">Binary/ordinal variables<a class="anchor" aria-label="anchor" href="#binaryordinal-variables"></a>
</h2>
<p><code><a href="../reference/power_interaction_r2.html">power_interaction_r2()</a></code> assumes all variables are
continuous, with a normal distribution. <code><a href="../reference/power_interaction.html">power_interaction()</a></code>
simulates all variables as continuous and normal.
<strong>However</strong>, variables can be transformed so that they are
binary/ordinal (e.g., 5 discrete levels, though any value under 20 is
possible). Typically, when a continuous and normal variable is
transformed to be binary/ordinal, the correlations between that variable
and all other variables are reduced or altered. Sometimes, it makes
sense for this to happen in the power analysis. For example, say a
variable is continuous in the literature, and the effect sizes in the
power analysis are drawn from prior work with the continuous variable,
but in your analysis you’ve chosen to dichotomize that variable or to
measure that trait with a ordinal scale. In that case, the reduction in
correlations makes sense, because that accurately reflects your data
analysis and what your power will be. On the other hand, say a variable
<em>is</em> binary (at least in the literature), maybe you’re looking at
sex or diagnosis for a disorder. In that case, your input correlations
are the correlations <em>with the binary/ordinal variable</em>, so you
don’t want them to be reduced or altered.</p>
<p><code><a href="../reference/power_interaction.html">power_interaction()</a></code> distinguishes between these cases
with the <code>adjust.correlations</code> flag. The default is
<code>adjust.correlations = TRUE</code>. This indicates that the input
correlations are with the binary/ordinal variables. To circumvent the
problem of variable transformations altering correlations,
<code><a href="../reference/power_interaction.html">power_interaction()</a></code> runs a function to compute how much the
input correlations need to be adjusted so that the final output
variables have the correlation structure specified by the user. When
<code>adjust.correlations = FALSE</code>, this function is not run,
allowing the user to see the impact of variable transformations on the
correlation structure, and on their power.</p>
<p>The flags <code>k.x1</code>, <code>k.x2</code>, and <code>k.y</code>
control the number of discrete values each variable takes (i.e.,
<code>k.x1 =2</code> means that <code>x1</code> is a binary variable,
while <code>k.x2 = 5</code> means that <code>x2</code> is a
ordinal-variable).</p>
<div class="section level3">
<h3 id="binary">Binary<a class="anchor" aria-label="anchor" href="#binary"></a>
</h3>
<p>Here’s a single data set where x1, x2, and y are all binary. Note
that when <span class="math inline">\(Y\)</span> is binary, the analysis
is run as a logistic regression.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">=</span> <span class="fu"><a href="../reference/generate_interaction.html">generate_interaction</a></span><span class="op">(</span></span>
<span>                  N <span class="op">=</span> <span class="fl">450</span>,                        <span class="co"># sample size</span></span>
<span>                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                    <span class="co"># correlation between x1 and y</span></span>
<span>                  r.x2.y <span class="op">=</span> <span class="fl">.1</span>,                    <span class="co"># correlation between x2 and y</span></span>
<span>                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and x2</span></span>
<span>                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span>,                 <span class="co"># correlation between x1x2 and y</span></span>
<span>                  k.x1 <span class="op">=</span> <span class="fl">2</span>,                       <span class="co"># x1 is binary</span></span>
<span>                  k.x2 <span class="op">=</span> <span class="fl">2</span>,                       <span class="co"># x2 is binary</span></span>
<span>                  k.y <span class="op">=</span> <span class="fl">2</span>,                        <span class="co"># y is binary</span></span>
<span>                  adjust.correlations <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>     <span class="co"># Adjust correlations?  </span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_interaction.html">plot_interaction</a></span><span class="op">(</span>data <span class="op">=</span><span class="va">test_data</span> <span class="op">)</span></span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig8-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="ordinal">ordinal<a class="anchor" aria-label="anchor" href="#ordinal"></a>
</h3>
<p>Here’s an example showing the effects of artificially discretizing
<code>x1</code> on power. We see that power is lower when there are
fewer discrete values.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span></span>
<span>                  n.iter<span class="op">=</span><span class="fl">1000</span>,</span>
<span>                  N <span class="op">=</span> <span class="fl">450</span>,                        <span class="co"># sample size</span></span>
<span>                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                    <span class="co"># correlation between x1 and y</span></span>
<span>                  r.x2.y <span class="op">=</span> <span class="fl">.1</span>,                    <span class="co"># correlation between x2 and y</span></span>
<span>                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and x2</span></span>
<span>                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span>,                 <span class="co"># correlation between x1x2 and y</span></span>
<span>                  k.x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">8</span><span class="op">)</span>,             <span class="co"># x1 has 2-10 discrete values</span></span>
<span>                  adjust.correlations <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>    <span class="co"># Adjust correlations?  </span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_power_curve.html">plot_power_curve</a></span><span class="op">(</span><span class="va">power_test</span>,power_target <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span></span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig9-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="detailed-and-full-results">Detailed and full results<a class="anchor" aria-label="anchor" href="#detailed-and-full-results"></a>
</h2>
<p>Beyond power and the range of simple slopes,
<code><a href="../reference/power_interaction.html">power_interaction()</a></code> and <code><a href="../reference/power_interaction_r2.html">power_interaction_r2()</a></code>
generate a lot of additional information about the simulations. These
can be optionally returned using <code>detailed_results = TRUE</code>
and <code>full_simulation = TRUE</code> (for
<code><a href="../reference/power_interaction.html">power_interaction()</a></code> only). By default, both of these flags
are <code>FALSE</code>. <code>detailed_results</code> returns additional
information for each unique setting combination, including the mean
correlation structure between the simulated variables across
<code>niter</code> simulations, and the mean regression coefficients.
<code>full_simulation</code>, as the name suggests, returns the output
of <code><a href="../reference/test_interaction.html">test_interaction()</a></code> for every single simulated data set
that <code><a href="../reference/power_interaction.html">power_interaction()</a></code> generates. The output can be quite
large (i.e. if 10,000 simulations are run, it will have 10,000
rows).</p>
<div class="section level3">
<h3 id="detailed-results">Detailed results<a class="anchor" aria-label="anchor" href="#detailed-results"></a>
</h3>
<p>Let’s return to our example of examining a range of interaction
effect sizes, except now with <code>detailed_results = TRUE</code>. This
yields a lot more information about what the simulated data looked like,
on average.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">1000</span>,    <span class="co"># number of simulations</span></span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                  <span class="co"># p-value</span></span>
<span>                  N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">200</span>,<span class="fl">50</span><span class="op">)</span>  ,          <span class="co"># sample size</span></span>
<span>                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and y</span></span>
<span>                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,                  <span class="co"># correlation between x2 and y</span></span>
<span>                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                  <span class="co"># correlation between x1 and x2</span></span>
<span>                  r.x1x2.y <span class="op">=</span> <span class="fl">.4</span>,                 <span class="co"># correlation between x1x2 and y</span></span>
<span>                  detailed_results <span class="op">=</span> <span class="cn">TRUE</span>        <span class="co"># return detailed results       </span></span>
<span>                   <span class="op">)</span></span>
<span><span class="va">power_test</span></span></code></pre></div>
<pre><code><span><span class="co">##     N   pwr x1_pwr x2_pwr x1x2_est_mean x1x2_r2_mean crossover_mean shape_mean</span></span>
<span><span class="co">## 1  50 0.780  0.277  0.079     0.4426144    0.1763593     -0.1539197   3.210472</span></span>
<span><span class="co">## 2 100 0.979  0.509  0.100     0.3955305    0.1523973     -0.1629060   2.961055</span></span>
<span><span class="co">## 3 150 0.998  0.695  0.135     0.3910607    0.1526577     -0.1656292   3.206382</span></span>
<span><span class="co">## 4 200 0.998  0.823  0.155     0.3936075    0.1546993     -0.1607875   2.736218</span></span>
<span><span class="co">##   shape_q_2.5 shape_q_97.5 crossover_q_2.5 crossover_q_97.5    min.lwr</span></span>
<span><span class="co">## 1 -20.6471929    20.103591      -0.8424624        0.4985743 -0.5779247</span></span>
<span><span class="co">## 2   0.6913046    11.439831      -0.7250498        0.3597690 -0.4340121</span></span>
<span><span class="co">## 3   0.9342058     7.868203      -0.6388662        0.2561451 -0.3734257</span></span>
<span><span class="co">## 4   1.0795667     6.020076      -0.5102325        0.1646625 -0.3482832</span></span>
<span><span class="co">##     min.upr   max.lwr   max.upr x1x2_95_CI_2.5_mean x1x2_95_CI_97.5_mean</span></span>
<span><span class="co">## 1 0.2391543 0.1499189 0.9550447           0.1730314            0.7121974</span></span>
<span><span class="co">## 2 0.1677606 0.2346053 0.7952463           0.2112746            0.5797864</span></span>
<span><span class="co">## 3 0.1279905 0.2774962 0.7592573           0.2442872            0.5378341</span></span>
<span><span class="co">## 4 0.1071991 0.3042969 0.7259304           0.2672668            0.5199481</span></span>
<span><span class="co">##   x1x2_95_CI_width_mean r_y_x1x2_q_2.5 r_y_x1x2_q_50.0 r_y_x1x2_q_97.5</span></span>
<span><span class="co">## 1             0.5391660      0.2404203       0.4415142       0.6305032</span></span>
<span><span class="co">## 2             0.3685118      0.2190781       0.4014453       0.5758182</span></span>
<span><span class="co">## 3             0.2935468      0.2375604       0.3996108       0.5472230</span></span>
<span><span class="co">## 4             0.2526813      0.2658015       0.3986438       0.5217490</span></span>
<span><span class="co">##   x1_est_mean x2_est_mean r_x1_y_mean r_x2_y_mean r_x1_x2_mean r_y_x1x2_mean</span></span>
<span><span class="co">## 1   0.1922320  0.06429109   0.1969611  0.10240447    0.2083746     0.4360222</span></span>
<span><span class="co">## 2   0.1877368  0.06183341   0.1938392  0.09652172    0.1993411     0.3960011</span></span>
<span><span class="co">## 3   0.1915144  0.06219301   0.2028635  0.10097609    0.1989817     0.3964685</span></span>
<span><span class="co">## 4   0.1909169  0.06193294   0.2005727  0.09768533    0.1993219     0.3961706</span></span>
<span><span class="co">##   r_x1_x1x2_mean r_x2_x1x2_mean</span></span>
<span><span class="co">## 1  -1.058919e-02   -0.002177245</span></span>
<span><span class="co">## 2  -8.850879e-03   -0.002288713</span></span>
<span><span class="co">## 3   7.677160e-06    0.003463617</span></span>
<span><span class="co">## 4  -4.323312e-03   -0.003413765</span></span></code></pre>
<p>What is all this?</p>
<p>The first two columns are our standard output, the setting that was
varied across simulations, and the power. Next we have
<code>x1_pwr1</code> and <code>x2_pwr</code>. This is the power to
detect an effect of x1 and x2 <em>in the interaction model</em>.
<code>x1x2_est_mean</code> and <code>x1x2_r2_mean</code> are then the
<em>mean</em> effect size (<span class="math inline">\(B_3\)</span>) and
mean change in the adjusted <span class="math inline">\(R^2\)</span> (or
pseudo-<span class="math inline">\(R^2\)</span> when <span class="math inline">\(Y\)</span> is binary) when the interaction term
<span class="math inline">\(X_1X_2\)</span> is added to the model.
<code>crossover</code> and <code>shape</code> are the value of <span class="math inline">\(X_1\)</span> where the <span class="math inline">\(X_2\)</span> simple slopes intersect, and the
shape of the interaction (<span class="math inline">\(B_3 /
B_1\)</span>), which reflects whether it is a knock-out, attenuated, or
crossover interaction. We also give the mean upper and lower bounds of
the 95% confidence interval of the shape and crossover.</p>
<p>For example, one interesting insight we can gain here is that even
though <code>n=50</code> has <em>76%</em> power in this analysis, the
<em>observed</em> <code>shape</code> will vary widely. The confidence
interval indicates that it is even likely that we will observe
significant effects where the interaction has the <em>opposite</em>
shape from anticipated. In fact, we don’t see 95% of simulations
yielding a shape that is consistent with our hypothesis that
<code>r.x1x2.y &gt; r.x1.y</code>, until <code>N=200</code>, which has
<em>99.99%</em> power!</p>
<p>Next we have <code>min.lwr</code>, <code>min.upr</code>,
<code>max.lwr</code>, and <code>max.upr</code>. These reflect the range
of simple-slopes that were observed in the simulations where the
interaction was significant. By default, the number of simple slopes
(<code>q</code>) is 2 (i.e. a 50/50 split), and <span class="math inline">\(X_2\)</span> is the variable being conditioned on.
The ranges reflect that the majority of the lower simple slope ranges
from -0.05 to .2, and the upper simple slope ranges from .2 to .45. The
proportion of the simple slopes reflected by these ranges can be
controlled with the <code>IQR</code> flag. The default value for
<code>IQR</code> is 1.5, which means that the output ranges are the
median lower and upper simple slope, +/- 1.5 IQRs (an IQR is the 75th
percentile - 25th percentile). This output is intended to give further
insight into the effect sizes detected by the simulation.</p>
<p><code>x1x2_95_CI_2.5_mean</code> and
<code>x1x2_95_CI_97.5_mean</code> are the mean lower and upper 95%
confidence intervals of the interaction term, and
<code>x1x2_95_CI_width_mean</code> is the mean width of the confidence
interval. Similarly, <code>r_y_x1x2_q_2.5</code>,
<code>r_y_x1x2_q_50.0</code>, and <code>r_y_x1x2_q_97.5</code> are
quantiles (2.5%, 50%, and 97.5%) of the correlation between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_1X_2\)</span> when the interaction is
significant.</p>
<p><code>x1_est_mean</code> and <code>x2_est_mean</code> are the mean
main effects of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>, and <code>pwr_x1</code> and
<code>pwr_x2</code> is the power to detect those main effects, in the
context of the full interaction regression.</p>
</div>
<div class="section level3">
<h3 id="full-results">Full results<a class="anchor" aria-label="anchor" href="#full-results"></a>
</h3>
<p><code>full_results</code> can be useful when one wants a better grasp
of what goes into the power analysis. If we return to our first example,
we can see what range of sample-level correlations one can expect to
see, given a population-level correlation:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">942141</span><span class="op">)</span></span>
<span><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">1000</span>,  <span class="co"># number of simulations</span></span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.05</span>,   <span class="co"># p-value</span></span>
<span>                  N <span class="op">=</span> <span class="fl">350</span>,        <span class="co"># sample size</span></span>
<span>                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,    <span class="co"># correlation between x1 and y</span></span>
<span>                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,   <span class="co"># correlation between x2 and y</span></span>
<span>                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,   <span class="co"># correlation between x1 and x2</span></span>
<span>                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span>, <span class="co"># correlation between x1x2 and y</span></span>
<span>                  full_simulation <span class="op">=</span> <span class="cn">T</span>, <span class="co"># return the full simulation results     </span></span>
<span>                  detailed_results <span class="op">=</span> <span class="cn">T</span> <span class="co"># get detailed results, including correlations</span></span>
<span>                   <span class="op">)</span></span>
<span><span class="co"># the standard output:</span></span>
<span><span class="va">power_test</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<pre><code><span><span class="co">##     N   pwr x1_pwr x2_pwr x1x2_est_mean x1x2_r2_mean crossover_mean shape_mean</span></span>
<span><span class="co">## 1 350 0.808  0.949  0.207     0.1652355   0.02668037     -0.3782685  0.9575423</span></span>
<span><span class="co">##   shape_q_2.5 shape_q_97.5 crossover_q_2.5 crossover_q_97.5    min.lwr</span></span>
<span><span class="co">## 1   0.4320577     1.978912        -1.19942        0.3104526 -0.0780142</span></span>
<span><span class="co">##     min.upr   max.lwr   max.upr x1x2_95_CI_2.5_mean x1x2_95_CI_97.5_mean</span></span>
<span><span class="co">## 1 0.2031697 0.1853961 0.4726258          0.06420129            0.2662696</span></span>
<span><span class="co">##   x1x2_95_CI_width_mean r_y_x1x2_q_2.5 r_y_x1x2_q_50.0 r_y_x1x2_q_97.5</span></span>
<span><span class="co">## 1             0.2020683     0.09287497       0.1652633        0.258831</span></span>
<span><span class="co">##   x1_est_mean x2_est_mean r_x1_y_mean r_x2_y_mean r_x1_x2_mean r_y_x1x2_mean</span></span>
<span><span class="co">## 1   0.1916138  0.05885155    0.202843  0.09743667    0.2009862     0.1675586</span></span>
<span><span class="co">##   r_x1_x1x2_mean r_x2_x1x2_mean</span></span>
<span><span class="co">## 1   -0.001093734    0.002505613</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># range of correlations when the test is significant</span></span>
<span></span>
<span><span class="va">quants</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.025</span>,<span class="fl">.25</span>,<span class="fl">.5</span>,<span class="fl">.75</span>,<span class="fl">.975</span>,<span class="fl">1</span><span class="op">)</span> <span class="co">#quantiles</span></span>
<span></span>
<span><span class="va">power_test</span><span class="op">$</span><span class="va">simulation</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sig_int</span> <span class="op">==</span><span class="fl">1</span> <span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># only significant results</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="va">quants</span>,</span>
<span>                   qs <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">r_y_x1x2</span>,<span class="va">quants</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in</span></span>
<span><span class="co">## dplyr 1.1.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `reframe()` instead.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> When switching from `summarise()` to `reframe()`, remember that `reframe()`</span></span>
<span><span class="co">##   always returns an ungrouped data frame and adjust accordingly.</span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<pre><code><span><span class="co">##    prob         qs</span></span>
<span><span class="co">## 1 0.000 0.05200316</span></span>
<span><span class="co">## 2 0.025 0.09287497</span></span>
<span><span class="co">## 3 0.250 0.13391873</span></span>
<span><span class="co">## 4 0.500 0.16526331</span></span>
<span><span class="co">## 5 0.750 0.19832108</span></span>
<span><span class="co">## 6 0.975 0.25883097</span></span>
<span><span class="co">## 7 1.000 0.30228835</span></span></code></pre>
<p>When <span class="math inline">\(B_3\)</span> is significant
(<code>sig_int == 1</code>), 95% of the observed sample-level
correlations range from 0.1 to 0.25, even though the population-level
correlation is 0.15! Also note that more than half of the observed
<em>significant</em> effect sizes are greater than 0.15, even though the
median of <em>all</em> effects is 0.15. This is why <em>post-hoc</em>
power-analyses using the observed effect-sizes in your sample are
typically not a great idea. Because the choice to run the power analysis
is conditioned on the result being significant, you’ve effectively
subjected yourself to publication bias, and as a result the power
analysis will tend to yield an inflated estimate of power.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by David Baranger, Andrew Castillo.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
