<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The InteractionPoweR Package • InteractionPoweR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="The InteractionPoweR Package">
<meta property="og:description" content="This article describes how to use InteractionPoweR and also explains how the functions underlying this package work.">
<meta property="og:image" content="https://dbaranger.github.io/InteractionPoweR/logo.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@David_Baranger">
<meta name="twitter:site" content="@David_Baranger">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-36JVDTC1K0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-36JVDTC1K0');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">InteractionPoweR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/InteractionPoweRvignette.html">The InteractionPoweR Package</a>
    </li>
    <li>
      <a href="../articles/CommonQuestions.html">Questions &amp; Errors</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dbaranger/InteractionPoweR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The InteractionPoweR Package</h1>
                        <h4 data-toc-skip class="author">David AA Baranger</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dbaranger/InteractionPoweR/blob/HEAD/vignettes/articles/InteractionPoweRvignette.Rmd" class="external-link"><code>vignettes/articles/InteractionPoweRvignette.Rmd</code></a></small>
      <div class="hidden name"><code>InteractionPoweRvignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Interaction analyses take the form:</p>
<p><span class="math display">\[
Y \sim \beta_0 + X_1\beta_1 + X_2\beta_2 + X_1X_2\beta_3 + \epsilon
\]</span></p>
<p>Where <span class="math inline">\(Y\)</span> is the dependent variable, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are our independent variables, and our interaction term is <span class="math inline">\(X_1X_2\)</span>. The <span class="math inline">\(\beta\)</span>s in this equation are our regression coefficients and <span class="math inline">\(\epsilon\)</span> is our error. Note that in this equation, and throughout the code in this package, we refer to the two interacting variables as <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>, as opposed to <span class="math inline">\(X\)</span> and <span class="math inline">\(Z\)</span>, or <span class="math inline">\(X\)</span> and <span class="math inline">\(M\)</span>. This is to emphasize that, as far as these simulations are concerned, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are interchangeable, and any conclusions about causality (i.e. “moderation”) will rely on the specifics of the variables.</p>
<p>The goal of the power analyses supported by this package is to determine how much power an analysis has to detect whether <span class="math inline">\(\beta_3\)</span> (the interaction term regression coefficient) is different from 0 at some pre-specified <span class="math inline">\(\alpha\)</span> value (<code>alpha</code>, or p-value). <span class="math inline">\(\alpha\)</span> refers to our <em>false positive rate</em>, which is how frequently we will accept that our analysis has incorrectly rejected the null hypothesis. <strong>Power</strong>, refers to our <em>true positive rate</em>, how frequently do we want to correctly accept the alternative hypothesis? It may be easier to think about the inverse of power, the <em>false negative rate</em>: how frequently will we incorrectly accept the null hypothesis? A “typical” (though not necessarily recommended) value for power is 0.8, which means that 20%, or <span class="math inline">\(1/5\)</span>, of the time, the analysis will <em>incorrectly</em> conclude that there is no effect when there actually is one. (We recommend striving for at least a power of .9)</p>
</div>
<div class="section level2">
<h2 id="effect-sizes">Effect sizes<a class="anchor" aria-label="anchor" href="#effect-sizes"></a>
</h2>
<p>Any simulation in this package requires at minimum 5 input variables:</p>
<ol style="list-style-type: decimal">
<li>
<code>N</code>: the sample size.</li>
<li>
<code>r.x1.y</code>: the Pearson’s correlation (<span class="math inline">\(r\)</span>) between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y\)</span>
</li>
<li>
<code>r.x2.y</code>: the Pearson’s correlation (<span class="math inline">\(r\)</span>) between <span class="math inline">\(X_2\)</span> and <span class="math inline">\(Y\)</span>
</li>
<li>
<code>r.x1.x2</code>: the Pearson’s correlation (<span class="math inline">\(r\)</span>) between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>
</li>
<li>
<code>r.x1x2.y</code>: the Pearson’s correlation (<span class="math inline">\(r\)</span>) between <span class="math inline">\(X_1X_2\)</span> and <span class="math inline">\(Y\)</span> - this is the interaction effect</li>
</ol>
<p>It is important to emphasize here that inputs 2-5 are the population-level <em>Pearson’s correlation</em> between each pair of variables. This is true even if any or all of the variables in the simulation are binary. These correlations are used to derive the regression coefficients via path tracing rules. Also note that these effect sizes are the <em>cross-sectional</em> correlation. This is in contrast to how one specifies effects for experimental manipulations, where the effects are the correlation in each of the experimental conditions. The Pearson’s correlation is equivalent to the effect size <span class="math inline">\(\beta\)</span> (i.e. in the regression <span class="math inline">\(Y \sim \beta_0 + X\beta + \epsilon\)</span>) when both <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> are normalized (mean = 0, sd = 1). For inputs 2-4, we imagine that it will be relatively straightforward for most users to identify the appropriate values (i.e. by surveying the literature and identifying large independent studies where the effects have been reported). However, in the case of the interaction effect size, <code>r.x1x2.y</code>, users may be less used to thinking about interaction effects as correlations. The interaction effect size is the how much the correlation between one of the two independent variables and the dependent variable changes when <em>conditioned</em> on the other independent variable. It is both how much <span class="math inline">\(corr(X_1,Y)\)</span> changes when conditioned on <span class="math inline">\(X_2\)</span>, and equivalently how much <span class="math inline">\(corr(X_2,Y)\)</span> changes when conditioned on <span class="math inline">\(X_1\)</span>.</p>
<p>A common way of thinking about interaction effect sizes is to plot the data as “simple slopes”. A simple slopes plot shows the correlation between one of the independent variables (e.g. <span class="math inline">\(X_1\)</span>) and the dependent variable (<span class="math inline">\(Y\)</span>) in different subsets of the data, where each subset is defined by their value at the second independent variable (e.g. <span class="math inline">\(X_2\)</span>). For example, we can plot <span class="math inline">\(Y \sim X_1\)</span> separately in participants with an <span class="math inline">\(X_2\)</span> value in the lower-half of the distribution and the upper-half of the distribution.</p>
<div class="section level3">
<h3 id="simulating-single-data-sets">Simulating single data sets<a class="anchor" aria-label="anchor" href="#simulating-single-data-sets"></a>
</h3>
<p>To facilitate user’s understanding of interaction effect sizes, <code>InteractionPoweR</code> includes functions for simulating single data sets and plotting the interaction as a simple slopes plot:</p>
<p>The function <code><a href="../reference/generate_interaction.html">generate_interaction()</a></code> simulates a single data set:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbaranger.github.io/InteractionPoweR">InteractionPoweR</a></span><span class="op">)</span>
<span class="va">example_data</span> <span class="op">=</span> <span class="fu"><a href="../reference/generate_interaction.html">generate_interaction</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">350</span>,        <span class="co"># sample size</span>
                                    r.x1.y <span class="op">=</span> <span class="fl">.2</span>,    <span class="co"># correlation between x1 and y</span>
                                    r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,   <span class="co"># correlation between x2 and y</span>
                                    r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,   <span class="co"># correlation between x1 and x2</span>
                                    r.x1x2.y <span class="op">=</span> <span class="fl">.15</span>  <span class="co"># correlation between x1x2 and y</span>
                                      <span class="op">)</span></code></pre></div>
<p>The data can then be plotted using the <code><a href="../reference/plot_interaction.html">plot_interaction()</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_interaction.html">plot_interaction</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example_data</span>, <span class="co"># simulated data</span>
                 q <span class="op">=</span> <span class="fl">2</span>                <span class="co"># number of simple slopes</span>
                 <span class="op">)</span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig1-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The function <code><a href="../reference/test_interaction.html">test_interaction()</a></code> provides easy access to the results of the interaction regression, the adjusted <span class="math inline">\(R^2\)</span> of the interaction term, the 95% confidence interval of the interaction term, the shape of the interaction (<code>crossover.point</code> = the value of <span class="math inline">\(X_1\)</span> where the <span class="math inline">\(X_2\)</span> simple-slopes intersect, <code>shape</code> = the shape of the interaction, &gt;1 = cross-over, 1 = knock-out, &lt;1 = attenuated), the simple slopes of <span class="math inline">\(X_2\)</span>, and the correlation between the variables:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/test_interaction.html">test_interaction</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example_data</span>, <span class="co"># simulated data</span>
                 q <span class="op">=</span> <span class="fl">2</span>                <span class="co"># number of simple slopes</span>
                 <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $linear.model</span>
<span class="co">##        Estimate Std. Error   t value     Pr(&gt;|t|)</span>
<span class="co">## x1   0.24544007 0.05233738 4.6895753 3.946133e-06</span>
<span class="co">## x2   0.04921257 0.05271626 0.9335368 3.511939e-01</span>
<span class="co">## x1x2 0.16050539 0.05260643 3.0510603 2.456507e-03</span>
<span class="co">## </span>
<span class="co">## $x1x2.adjusted.r2</span>
<span class="co">## [1] 0.02193642</span>
<span class="co">## </span>
<span class="co">## $x1x2.confint</span>
<span class="co">##   x1x2_95confint_2.5 x1x2_95confint_97.5</span>
<span class="co">## 1         0.05703676            0.263974</span>
<span class="co">## </span>
<span class="co">## $interaction.shape</span>
<span class="co">##   crossover.point     shape</span>
<span class="co">## 1      -0.3066101 0.6539494</span>
<span class="co">## </span>
<span class="co">## $simple.slopes</span>
<span class="co">##    lower.slope upper.slope</span>
<span class="co">## x2   0.1274174   0.3741865</span>
<span class="co">## </span>
<span class="co">## $correlation</span>
<span class="co">##            cor v1   v2</span>
<span class="co">## 5   0.20000000 x1   x2</span>
<span class="co">## 9   0.25793592 x1    y</span>
<span class="co">## 10  0.07925461 x2    y</span>
<span class="co">## 13  0.01683450 x1 x1x2</span>
<span class="co">## 14 -0.12084000 x2 x1x2</span>
<span class="co">## 15  0.15579822  y x1x2</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="a-simple-power-analysis">A simple power analysis<a class="anchor" aria-label="anchor" href="#a-simple-power-analysis"></a>
</h2>
<p>The simplest power analysis we can run is one in which all the parameters are already known. All the correlations are known, the sample size is known, and the interaction effect size is known. The power analysis is run with the function <code><a href="../reference/power_interaction.html">power_interaction()</a></code>. We additionally specify <code>alpha</code>, which is the p-value we’re using (0.05 is default), and <code>n.iter</code>, which is the number of simulations run. In this example we’ll use just 1,000 simulations, but we recommend using 10,000 for more stable results. Also note that in all these examples the parameter <code>seed</code> is set. This is the seed for the random number generator, which will allow you to obtain the same results. However, we recommend not setting <code>seed</code> when running your own power analyses, at least until you are ready to share the results. Each time an analysis is run a new seed will be chosen and echoed, so that you will be able to reproduce your results.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">1000</span>,  <span class="co"># number of simulations</span>
                  alpha <span class="op">=</span> <span class="fl">0.05</span>,   <span class="co"># p-value</span>
                  N <span class="op">=</span> <span class="fl">350</span>,        <span class="co"># sample size</span>
                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,    <span class="co"># correlation between x1 and y</span>
                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,   <span class="co"># correlation between x2 and y</span>
                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,   <span class="co"># correlation between x1 and x2</span>
                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span>, <span class="co"># correlation between x1x2 and y</span>
                  seed <span class="op">=</span> <span class="fl">290115</span>  <span class="op">)</span><span class="co"># seed</span></code></pre></div>
<pre><code><span class="co">## [1] "Checking for errors in inputs..."</span>
<span class="co">## [1] "Performing 1000 simulations"</span></code></pre>
<pre><code><span class="co">## Warning: executing %dopar% sequentially: no parallel backend registered</span></code></pre>
<pre><code><span class="co">##     N   pwr</span>
<span class="co">## 1 350 0.825</span></code></pre>
<p>We find that our analysis has 82% power (<code>pwr</code>).</p>
</div>
<div class="section level2">
<h2 id="exploring-the-parameter-space">Exploring the parameter space<a class="anchor" aria-label="anchor" href="#exploring-the-parameter-space"></a>
</h2>
<p>Typically not all variables are known in a power analysis. For example, we know the magnitude of the interaction effect we’re interested in, and we want to learn what sample size would be needed to detect that effect with 90% power. Or we have a sample already, and we want to learn what is the smallest effect we can detect with 90% power. To answer these questions, the user simply needs to provide the range of parameters that they would like the analysis to use. Almost any of the input parameters can be ranges, and the analysis runs <code>n.iter</code> simulations for every combination of input parameters.</p>
<p>As the number of input parameters increase, so too does the total number of simulations. To reduce the amount of time an analysis takes, <code><a href="../reference/power_interaction.html">power_interaction()</a></code> supports running simulations in parallel. The number of cores to be used for the parallel simulation is indicated by the <code>cl</code> flag (we recommend a number between 4 - 6 on most personal computers).</p>
<div class="section level3">
<h3 id="finding-the-optimal-sample-size">Finding the optimal sample size<a class="anchor" aria-label="anchor" href="#finding-the-optimal-sample-size"></a>
</h3>
<p>For example, to explore multiple sample sizes we can set <code>N = seq(200,600,by = 50)</code>, which runs a simulation for N = 200, 250, 300 etc, up to N=500. Equivalently, we could also set <code>N  = c(200,250,300,350,400,450,500,550,600)</code>, but the former is faster to write.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">1000</span>,    <span class="co"># number of simulations</span>
                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                  <span class="co"># p-value</span>
                  N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">600</span>,by <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,      <span class="co"># sample size</span>
                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and y</span>
                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,                  <span class="co"># correlation between x2 and y</span>
                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                  <span class="co"># correlation between x1 and x2</span>
                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span>,                <span class="co"># correlation between x1x2 and y</span>
                  cl <span class="op">=</span> <span class="fl">2</span>,                        <span class="co"># number of clusters for parallel analyses</span>
                  seed <span class="op">=</span> <span class="fl">507421</span>        <span class="op">)</span>         <span class="co"># seed</span></code></pre></div>
<pre><code><span class="co">## [1] "Checking for errors in inputs..."</span>
<span class="co">## [1] "Performing 9000 simulations"</span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">power_test</span></code></pre></div>
<pre><code><span class="co">##     N   pwr</span>
<span class="co">## 6 200 0.567</span>
<span class="co">## 7 250 0.670</span>
<span class="co">## 1 300 0.760</span>
<span class="co">## 2 350 0.824</span>
<span class="co">## 3 400 0.868</span>
<span class="co">## 4 450 0.907</span>
<span class="co">## 8 500 0.907</span>
<span class="co">## 9 550 0.934</span>
<span class="co">## 5 600 0.961</span></code></pre>
<p>We can plot these results using the function <code><a href="../reference/plot_power_curve.html">plot_power_curve()</a></code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_power_curve.html">plot_power_curve</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span>, <span class="co"># output from power_interaction()</span>
                 power_target <span class="op">=</span> <span class="fl">.9</span>        <span class="co"># the power we want to achieve </span>
                 <span class="op">)</span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig2-1.png" width="576" style="display: block; margin: auto;"></p>
<p>By eye-balling this plot, we can see that N=450 yields approximately 90% power, and N=330 yields approximately 80% power. The function <code><a href="../reference/power_estimate.html">power_estimate()</a></code> can be used to obtain a more precise answer. This function fits a regression model to the power results to estimate when a specific power will be achieved.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/power_estimate.html">power_estimate</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span>, <span class="co"># output from power_interaction()</span>
                        x <span class="op">=</span> <span class="st">"N"</span>,        <span class="co"># the variable we want a precise number for</span>
             power_target <span class="op">=</span> <span class="fl">0.9</span>         <span class="co"># the power we want to achieve </span>
<span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 441.0214</span></code></pre>
<p>Our guess turned out to be accurate in this case, and N=443 yields approximately 90% power.</p>
</div>
<div class="section level3">
<h3 id="finding-the-smallest-detectable-effect-size">Finding the smallest detectable effect size<a class="anchor" aria-label="anchor" href="#finding-the-smallest-detectable-effect-size"></a>
</h3>
<p>Another common use-case is when the sample size and variables-of-interest are known, and we want to know how small of an interaction effect can be detected at a certain power level. We can repeat the same steps as above, except this time <code>r.x1x2.y</code> will be a range of values.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">1000</span>,    <span class="co"># number of simulations</span>
                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                  <span class="co"># p-value</span>
                  N <span class="op">=</span> <span class="fl">350</span>                ,       <span class="co"># sample size</span>
                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and y</span>
                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,                  <span class="co"># correlation between x2 and y</span>
                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                  <span class="co"># correlation between x1 and x2</span>
                  r.x1x2.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.2</span>,by<span class="op">=</span><span class="fl">.01</span><span class="op">)</span>,  <span class="co"># correlation between x1x2 and y</span>
                  cl <span class="op">=</span> <span class="fl">2</span>,                        <span class="co"># number of clusters for parallel analyses</span>
                  seed <span class="op">=</span> <span class="fl">387455</span>        <span class="op">)</span>         <span class="co"># seed</span></code></pre></div>
<pre><code><span class="co">## [1] "Checking for errors in inputs..."</span>
<span class="co">## [1] "Performing 11000 simulations"</span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">power_test</span></code></pre></div>
<pre><code><span class="co">##    r.x1x2.y   pwr</span>
<span class="co">## 1      0.10 0.467</span>
<span class="co">## 7      0.11 0.536</span>
<span class="co">## 2      0.12 0.653</span>
<span class="co">## 3      0.13 0.680</span>
<span class="co">## 4      0.14 0.765</span>
<span class="co">## 5      0.15 0.804</span>
<span class="co">## 8      0.16 0.875</span>
<span class="co">## 9      0.17 0.904</span>
<span class="co">## 10     0.18 0.915</span>
<span class="co">## 6      0.19 0.941</span>
<span class="co">## 11     0.20 0.959</span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_power_curve.html">plot_power_curve</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span>, <span class="co"># output from power_interaction()</span>
                 power_target <span class="op">=</span> <span class="fl">.9</span>        <span class="co"># the power we want to achieve </span>
                 <span class="op">)</span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig3-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/power_estimate.html">power_estimate</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span>, <span class="co"># output from power_interaction()</span>
                        x <span class="op">=</span> <span class="st">"r.x1x2.y"</span>,        <span class="co"># the variable we want a precise number for</span>
             power_target <span class="op">=</span> <span class="fl">0.9</span>         <span class="co"># the power we want to achieve </span>
<span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.1712896</span></code></pre>
<p>We see that we have approximately 90% power to detect effects as small as <code>r.x1x2.y</code> = 0.17.</p>
<p>In some cases it may also be useful to take a look the distribution of simple slopes across the range of parameters tested. If we re-run our simulation using <code>detailed_results=T</code>, we can look at the distribution of effect sizes and simple slopes.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">1000</span>,    <span class="co"># number of simulations</span>
                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                  <span class="co"># p-value</span>
                  N <span class="op">=</span> <span class="fl">350</span>                ,       <span class="co"># sample size</span>
                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and y</span>
                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,                  <span class="co"># correlation between x2 and y</span>
                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                  <span class="co"># correlation between x1 and x2</span>
                  r.x1x2.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.2</span>,by<span class="op">=</span><span class="fl">.01</span><span class="op">)</span>,   <span class="co"># correlation between x1x2 and y</span>
                  cl <span class="op">=</span> <span class="fl">2</span>,                         <span class="co"># number of clusters for parallel analyses</span>
                  detailed_results <span class="op">=</span> <span class="cn">T</span>,           <span class="co"># detailed results</span>
                  seed <span class="op">=</span> <span class="fl">316834</span>                  <span class="co"># seed</span>
                <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "Checking for errors in inputs..."</span>
<span class="co">## [1] "Performing 11000 simulations"</span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_simple_slope.html">plot_simple_slope</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span><span class="op">)</span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig6-1.png" width="576" style="display: block; margin: auto;"></p>
<p>From this we can learn that the range of slopes that would be consistent with the smallest effect we are powered to detect, <code>r.x1x2.y</code>=0.17, is quite large. In particular, note that the lower slope could be negative, 0, or even fairly large in the positive direction - all consistent with <code>r.x1x2.y</code>=0.17. See the section below on <strong>Detailed Results</strong> for more information on all the outputs when <code>detailed.results = TRUE</code>.</p>
</div>
<div class="section level3">
<h3 id="varying-multiple-parameters">Varying multiple parameters<a class="anchor" aria-label="anchor" href="#varying-multiple-parameters"></a>
</h3>
<p>It is not uncommon that multiple parameters in the simulation are unknown. To find the power at every combination of the parameters, simply input a range of values for every unknown parameter in the simulation. We generally recommend to only vary up to 3 parameters at a time, any more and the simulation can take a <em>very</em> long time to run. For example, lets say there’s a range of plausible effect sizes for the interaction, and we want to know how large of a sample we would need to detect each of them. To test this, we can vary both <code>N</code> and <code>r.x1x2.y</code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">1000</span>,     <span class="co"># number of simulations</span>
                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                   <span class="co"># p-value</span>
                  N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">600</span>,by <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,       <span class="co"># sample size</span>
                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                    <span class="co"># correlation between x1 and y</span>
                  r.x2.y <span class="op">=</span> <span class="fl">.1</span>,                    <span class="co"># correlation between x2 and y</span>
                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>       ,            <span class="co"># correlation between x1 and x2</span>
                  r.x1x2.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.15</span>,<span class="fl">.2</span>,by<span class="op">=</span><span class="fl">.025</span><span class="op">)</span>, <span class="co"># correlation between x1x2 and y</span>
                  cl <span class="op">=</span> <span class="fl">2</span>,                         <span class="co"># number of clusters for parallel analyses</span>
                  detailed_results <span class="op">=</span> <span class="cn">T</span>,
                  seed <span class="op">=</span> <span class="fl">742425</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "Checking for errors in inputs..."</span>
<span class="co">## [1] "Performing 33000 simulations"</span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_power_curve.html">plot_power_curve</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span>, <span class="co"># output from power_interaction()</span>
                 power_target <span class="op">=</span> <span class="fl">.9</span>,       <span class="co"># the power we want to achieve </span>
                 x <span class="op">=</span> <span class="st">"N"</span>,                 <span class="co"># x-axis</span>
                 group <span class="op">=</span> <span class="st">"r.x1x2.y"</span>       <span class="co"># grouping variable</span>
                 <span class="op">)</span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig4-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/power_estimate.html">power_estimate</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span>, <span class="co"># output from power_interaction()</span>
                        x <span class="op">=</span> <span class="st">"N"</span>,        <span class="co"># the variable we want a precise number for</span>
             power_target <span class="op">=</span> <span class="fl">0.9</span>         <span class="co"># the power we want to achieve </span>
<span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   r.x1x2.y estimate</span>
<span class="co">## 1    0.150 447.9153</span>
<span class="co">## 2    0.175 330.1380</span>
<span class="co">## 3    0.200 250.1208</span></code></pre>
<p>From this we’ve learned that, depending on exactly what effect size we’re aiming for, we’ll need an <code>N</code> between 260 and 460.</p>
</div>
</div>
<div class="section level2">
<h2 id="reliability">Reliability<a class="anchor" aria-label="anchor" href="#reliability"></a>
</h2>
<p>Reliability is an important issue in statistics. Even if effects are large, if your measurements are unreliable, then you’ll be under-powered. This is especially true for interactions, as the reliability of both <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> influence power, as well as the reliability of <span class="math inline">\(Y\)</span>. In the context of <code>InteractionPoweR</code>, “reliability” means the proportion of the variance of each variable that is attributable to true signal, as opposed to measurement error. A reliability of ‘1’ (the default), means that your variables were measured with no error (reliability must be greater than 0, and less than or equal to 1). Common statistics that reflect reliability include test-retest reliability, inter-rater reliability, and Cronbach’s alpha. The flags <code>rel.x1</code>, <code>rel.x2</code>, and <code>rel.y</code> control the reliability of each simulated variable. We recommend exploring how much reliability will affect your power. For example:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">1000</span>,     <span class="co"># number of simulations</span>
                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                   <span class="co"># p-value</span>
                  N <span class="op">=</span> <span class="fl">450</span>,                        <span class="co"># sample size</span>
                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                    <span class="co"># correlation between x1 and y</span>
                  r.x2.y <span class="op">=</span> <span class="fl">.1</span>,                    <span class="co"># correlation between x2 and y</span>
                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and x2</span>
                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span>,                 <span class="co"># correlation between x1x2 and y</span>
                  rel.x1 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.4</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">.2</span><span class="op">)</span>,      <span class="co"># x1 reliability    </span>
                  rel.x2 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.4</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">.2</span><span class="op">)</span>,      <span class="co"># x2 reliability          </span>
                  rel.y  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.4</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">.2</span><span class="op">)</span>,      <span class="co"># y reliability          </span>
                  cl <span class="op">=</span> <span class="fl">2</span>,                         <span class="co"># number of clusters for parallel analyses</span>
                  seed <span class="op">=</span> <span class="fl">293437</span>        <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "Checking for errors in inputs..."</span>
<span class="co">## [1] "Performing 64000 simulations"</span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_power_curve.html">plot_power_curve</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span>, <span class="co"># output from power_interaction()</span>
                 power_target <span class="op">=</span> <span class="fl">.9</span>,       <span class="co"># the power we want to achieve </span>
                 x     <span class="op">=</span> <span class="st">"rel.x1"</span>,        <span class="co"># x-axis</span>
                 group <span class="op">=</span> <span class="st">"rel.x2"</span>,        <span class="co"># grouping variable</span>
                 facets<span class="op">=</span> <span class="st">"rel.y"</span>          <span class="co"># facets variable</span>
                 <span class="op">)</span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig5-1.png" width="576" style="display: block; margin: auto;"></p>
<p>These plots make it clear how large of an effect reliability will have on your results. In this simulation, even a reliability of “acceptable” or “good” (reliability = 0.8), is enough to bring our power down, from 0.9 to 0.63!</p>
</div>
<div class="section level2">
<h2 id="binaryordinal-and-skewed-variables">Binary/ordinal and skewed variables<a class="anchor" aria-label="anchor" href="#binaryordinal-and-skewed-variables"></a>
</h2>
<p><code>InteractionPoweR</code> simulates all variables as continuous and normal (skew=0). However, variables can be transformed so that they are binary/ordinal (e.g., 5 discrete levels, though any value under 20 is possible) and/or skewed. Typically, when a continuous and normal variable is transformed to be binary/ordinal and/or skewed, the correlations between that variable and all other variables are reduced or altered. Sometimes, it makes sense for this to happen in the power analysis. For example, say a variable is continuous in the literature, and the effect sizes in the power analysis are drawn from prior work with the continuous variable, but in your analysis you’ve chosen to dichotomize that variable or to measure that trait with a ordinal scale. In that case, the reduction in correlations makes sense, because that accurately reflects your data analysis and what your power will be. On the other hand, say a variable <em>is</em> binary (at least in the literature), maybe you’re looking at sex or diagnosis for a disorder. Or maybe you are looking at a variable that is skewed in the literature, such as alcohol consumption or depressive symptoms in the general population. In that case, your input correlations are the correlations <em>with the binary/skewed variable</em>, so you don’t want them to be reduced or altered.</p>
<p><code>InteractionPoweR</code> distinguishes between these cases with the <code>adjust.correlations</code> flag. The default is <code>adjust.correlations = TRUE</code>. This indicates that the input correlations are with the binary/ordinal/skewed variables. To circumvent the problem of variable transformations altering correlations, <code>InteractionPoweR</code> runs a function to compute how much the input correlations need to be adjusted so that the final output variables have the correlation structure specified by the user. When <code>adjust.correlations = FALSE</code>, this function is not run, allowing the user to see the impact of variable transformations on the correlation structure, and on their power.</p>
<p>The flags <code>skew.x1</code>, <code>skew.x2</code>, and <code>skew.y</code> control the skew of <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>, and <span class="math inline">\(Y\)</span>. We achieve skew by transforming the normally distributed variable to a skewed gamma distribution. The flags <code>k.x1</code>, <code>k.x2</code>, and <code>k.y</code> control the number of discrete values each variable takes (i.e., <code>k.x1 =2</code> means that <code>x1</code> is a binary variable, while <code>k.x2 = 5</code> means that <code>x2</code> is a ordinal-variable). If a variable is binary (i.e., <code>k=2</code>), the <code><a href="../reference/binary.p2skew.html">binary.p2skew()</a></code> convenience function can be used to compute the skew from the proportion of 0’s and 1’s (i.e. 50/50 = 0.5 = a skew of 0). If a variable is binarized but no skew is specified, skew will be set to <code>0</code> by default. The flags <code>transform.x1</code>, <code>transform.x2</code>, and <code>transform.y</code>are retained for backwards compatibility with prior versions of the package. Setting one of these to <code>"binary"</code> is equivalent to <code>k=2</code>.</p>
<div class="section level3">
<h3 id="binary">Binary<a class="anchor" aria-label="anchor" href="#binary"></a>
</h3>
<p>Here’s a single data set where x1, x2, and y are all binary. Note that when <span class="math inline">\(Y\)</span> is binary, the analysis is run as a logistic regression.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test_data</span> <span class="op">=</span> <span class="fu"><a href="../reference/generate_interaction.html">generate_interaction</a></span><span class="op">(</span>
                  N <span class="op">=</span> <span class="fl">450</span>,                        <span class="co"># sample size</span>
                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                    <span class="co"># correlation between x1 and y</span>
                  r.x2.y <span class="op">=</span> <span class="fl">.1</span>,                    <span class="co"># correlation between x2 and y</span>
                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and x2</span>
                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span>,                 <span class="co"># correlation between x1x2 and y</span>
                  k.x1 <span class="op">=</span> <span class="fl">2</span>,                       <span class="co"># x1 is binary</span>
                  k.x2 <span class="op">=</span> <span class="fl">2</span>,                       <span class="co"># x2 is binary</span>
                  k.y <span class="op">=</span> <span class="fl">2</span>,                        <span class="co"># y is binary</span>
                  adjust.correlations <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>     <span class="co"># Adjust correlations for skew?  </span>

<span class="fu"><a href="../reference/plot_interaction.html">plot_interaction</a></span><span class="op">(</span>data <span class="op">=</span><span class="va">test_data</span> <span class="op">)</span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig8-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="ordinal">ordinal<a class="anchor" aria-label="anchor" href="#ordinal"></a>
</h3>
<p>Here’s an example showing the effects of artificially discretizing <code>x1</code> on power. We see that power is lower when there are fewer discrete values.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span>
                  n.iter<span class="op">=</span><span class="fl">1000</span>,
                  N <span class="op">=</span> <span class="fl">450</span>,                        <span class="co"># sample size</span>
                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                    <span class="co"># correlation between x1 and y</span>
                  r.x2.y <span class="op">=</span> <span class="fl">.1</span>,                    <span class="co"># correlation between x2 and y</span>
                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and x2</span>
                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span>,                 <span class="co"># correlation between x1x2 and y</span>
                  k.x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">10</span>,<span class="fl">2</span><span class="op">)</span>,             <span class="co"># x1 has 2-10 discrete values</span>
                  adjust.correlations <span class="op">=</span> <span class="cn">FALSE</span>,cl<span class="op">=</span><span class="fl">2</span><span class="op">)</span>     <span class="co"># Adjust correlations for skew?  </span></code></pre></div>
<pre><code><span class="co">## [1] "Seed is 546648"</span>
<span class="co">## [1] "Checking for errors in inputs..."</span>
<span class="co">## [1] "Performing 5000 simulations"</span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_power_curve.html">plot_power_curve</a></span><span class="op">(</span><span class="va">power_test</span>,power_target <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig9-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="skew">Skew<a class="anchor" aria-label="anchor" href="#skew"></a>
</h3>
<p>We can also examine the effects on power when the actual variable is skewed:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">1000</span>,    <span class="co"># number of simulations</span>
                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                   <span class="co"># p-value</span>
                  N <span class="op">=</span> <span class="fl">450</span>,                        <span class="co"># sample size</span>
                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                    <span class="co"># correlation between x1 and y</span>
                  r.x2.y <span class="op">=</span> <span class="fl">.1</span>,                    <span class="co"># correlation between x2 and y</span>
                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and x2</span>
                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span>,                 <span class="co"># correlation between x1x2 and y</span>
                  skew.x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,by<span class="op">=</span><span class="fl">.25</span><span class="op">)</span>,      <span class="co"># x1 skew </span>
                  adjust.correlations <span class="op">=</span> <span class="cn">TRUE</span>,     <span class="co"># Adjust correlations for skew?</span>
                  cl <span class="op">=</span> <span class="fl">2</span> ,                        <span class="co"># number of clusters for parallel analyses</span>
                  seed <span class="op">=</span> <span class="fl">73070</span>      <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "Checking for errors in inputs..."</span>
<span class="co">## [1] "Adjusting correlations for variable transformations..."</span>
<span class="co">## [1] "Performing 9000 simulations"</span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_power_curve.html">plot_power_curve</a></span><span class="op">(</span>power_data <span class="op">=</span> <span class="va">power_test</span>, <span class="co"># output from power_interaction()</span>
                 power_target <span class="op">=</span> <span class="fl">.9</span>       <span class="co"># the power we want to achieve </span>
                 <span class="op">)</span></code></pre></div>
<p><img src="InteractionPoweRvignette_files/figure-html/fig7-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="detailed-and-full-results">Detailed and full results<a class="anchor" aria-label="anchor" href="#detailed-and-full-results"></a>
</h2>
<p>Beyond power and the range of simple slopes, <code>InteractionPoweR</code> generates a lot of additional information about the simulations. These can be optionally returned using <code>detailed_results = TRUE</code> and <code>full_simulation = TRUE</code>. By default, both of these flags are <code>FALSE</code>. <code>detailed_results</code> returns additional information for each unique setting combination, including the mean correlation structure between the simulated variables across <code>niter</code> simulations, and the mean regression coefficients. <code>full_simulation</code>, as the name suggests, returns the output of <code><a href="../reference/test_interaction.html">test_interaction()</a></code> for every single simulated data set that <code><a href="../reference/power_interaction.html">power_interaction()</a></code> generates. The output can be quite large (i.e. if 10,000 simulations are run, it will have 10,000 rows).</p>
<div class="section level3">
<h3 id="detailed-results">Detailed results<a class="anchor" aria-label="anchor" href="#detailed-results"></a>
</h3>
<p>Let’s return to our example of examining a range of interaction effect sizes, except now with <code>detailed_results = TRUE</code>. This yields a lot more information about what the simulated data looked like, on average.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">1000</span>,    <span class="co"># number of simulations</span>
                  alpha <span class="op">=</span> <span class="fl">0.05</span>,                  <span class="co"># p-value</span>
                  N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">200</span>,<span class="fl">50</span><span class="op">)</span>  ,       <span class="co"># sample size</span>
                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,                   <span class="co"># correlation between x1 and y</span>
                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,                  <span class="co"># correlation between x2 and y</span>
                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,                  <span class="co"># correlation between x1 and x2</span>
                  r.x1x2.y <span class="op">=</span> <span class="fl">.4</span>,                 <span class="co"># correlation between x1x2 and y</span>
                  cl <span class="op">=</span> <span class="fl">2</span>,                        <span class="co"># number of clusters for parallel analyses</span>
                  detailed_results <span class="op">=</span> <span class="cn">TRUE</span>        <span class="co"># return detailed results       </span>
                   <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "Seed is 8564"</span>
<span class="co">## [1] "Checking for errors in inputs..."</span>
<span class="co">## [1] "Performing 4000 simulations"</span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">power_test</span></code></pre></div>
<pre><code><span class="co">##     N   pwr x1_pwr x2_pwr x1x2_est_mean x1x2_r2_mean crossover_mean shape_mean</span>
<span class="co">## 1  50 0.784  0.724  0.934     0.4396218    0.1755323     -0.1768402   2.778960</span>
<span class="co">## 2 100 0.975  0.514  0.898     0.4000345    0.1557723     -0.1727934   3.125164</span>
<span class="co">## 3 150 0.997  0.330  0.859     0.3935693    0.1536631     -0.1777844   8.743583</span>
<span class="co">## 4 200 1.000  0.205  0.823     0.3900645    0.1534402     -0.1752575   2.637965</span>
<span class="co">##   shape_q_2.5 shape_q_97.5 crossover_q_2.5 crossover_q_97.5    min.lwr</span>
<span class="co">## 1   -7.402391    25.714963      -0.9012369        0.4309545 -0.5372973</span>
<span class="co">## 2   -5.538762    10.500007      -0.7753002        0.3325565 -0.4444916</span>
<span class="co">## 3    0.983842     8.178442      -0.6103052        0.2283472 -0.3815869</span>
<span class="co">## 4    1.078535     7.039999      -0.5469701        0.1513282 -0.3440493</span>
<span class="co">##      min.upr   max.lwr   max.upr x1x2_95_CI_2.5_mean x1x2_95_CI_97.5_mean</span>
<span class="co">## 1 0.21347774 0.1543921 0.9334462           0.1715979            0.7076457</span>
<span class="co">## 2 0.16010414 0.2160005 0.8039076           0.2158121            0.5842568</span>
<span class="co">## 3 0.11317787 0.2744178 0.7448703           0.2457943            0.5413442</span>
<span class="co">## 4 0.07411264 0.2878489 0.7230726           0.2638026            0.5163264</span>
<span class="co">##   x1x2_95_CI_width_mean r_y_x1x2_q_2.5 r_y_x1x2_q_50.0 r_y_x1x2_q_97.5</span>
<span class="co">## 1             0.5360477      0.2363389       0.4291214       0.6617950</span>
<span class="co">## 2             0.3684447      0.2231182       0.4017803       0.5740193</span>
<span class="co">## 3             0.2955499      0.2341655       0.3996251       0.5487754</span>
<span class="co">## 4             0.2525239      0.2560891       0.3965004       0.5297396</span>
<span class="co">##   x1_est_mean x2_est_mean r_x1_y_mean r_x2_y_mean r_x1_x2_mean r_y_x1x2_mean</span>
<span class="co">## 1   0.1858322  0.07120646   0.1944123  0.10839836    0.2072784     0.4343746</span>
<span class="co">## 2   0.1846094  0.06539229   0.1927725  0.09836801    0.1998706     0.4011194</span>
<span class="co">## 3   0.1831947  0.06753903   0.1960705  0.10578625    0.1991194     0.3964611</span>
<span class="co">## 4   0.1816829  0.06666561   0.1943286  0.10210319    0.1992850     0.3945857</span>
<span class="co">##   r_x1_x1x2_mean r_x2_x1x2_mean</span>
<span class="co">## 1  -0.0083153420   0.0003857908</span>
<span class="co">## 2  -0.0065243208  -0.0064658513</span>
<span class="co">## 3   0.0015769269   0.0067135435</span>
<span class="co">## 4  -0.0002570351  -0.0015671365</span></code></pre>
<p>What is all this?</p>
<p>The first two columns are our standard output, the setting that was varied across simulations, and the power. Next we have <code>x1_pwr1</code> and <code>x2_pwr</code>. This is the power to detect an effect of x1 and x2 <em>in the interaction model</em>. <code>x1x2_est_mean</code> and <code>x1x2_r2_mean</code> are then the <em>mean</em> effect size (<span class="math inline">\(B_3\)</span>) and mean change in the adjusted <span class="math inline">\(R^2\)</span> (or pseudo-<span class="math inline">\(R^2\)</span> when <span class="math inline">\(Y\)</span> is binary) when the interaction term <span class="math inline">\(X_1X_2\)</span> is added to the model. <code>crossover</code> and <code>shape</code> are the value of <span class="math inline">\(X_1\)</span> where the <span class="math inline">\(X_2\)</span> simple slopes intersect, and the shape of the interaction (<span class="math inline">\(B_3 / B_1\)</span>), which reflects whether it is a knock-out, attenuated, or crossover interaction. We also give the mean upper and lower bounds of the 95% confidence interval of the shape and crossover.</p>
<p>For example, one interesting insight we can gain here is that even though <code>n=50</code> has <em>76%</em> power in this analysis, the <em>observed</em> <code>shape</code> will vary widely. The confidence interval indicates that it is even likely that we will observe significant effects where the interaction has the <em>opposite</em> shape from anticipated. In fact, we don’t see 95% of simulations yielding a shape that is consistent with our hypothesis that <code>r.x1x2.y &gt; r.x1.y</code>, until <code>N=200</code>, which has <em>99.99%</em> power!</p>
<p>Next we have <code>min.lwr</code>, <code>min.upr</code>, <code>max.lwr</code>, and <code>max.upr</code>. These reflect the range of simple-slopes that were observed in the simulations where the interaction was significant. By default, the number of simple slopes (<code>q</code>) is 2 (i.e. a 50/50 split), and <span class="math inline">\(X_2\)</span> is the variable being conditioned on. The ranges reflect that the majority of the lower simple slope ranges from -0.05 to .2, and the upper simple slope ranges from .2 to .45. The proportion of the simple slopes reflected by these ranges can be controlled with the <code>IQR</code> flag. The default value for <code>IQR</code> is 1.5, which means that the output ranges are the median lower and upper simple slope, +/- 1.5 IQRs (an IQR is the 75th percentile - 25th percentile). This output is intended to give further insight into the effect sizes detected by the simulation.</p>
<p><code>x1x2_95_CI_2.5_mean</code> and <code>x1x2_95_CI_97.5_mean</code> are the mean lower and upper 95% confidence intervals of the interaction term, and <code>x1x2_95_CI_width_mean</code> is the mean width of the confidence interval. Similarly, <code>r_y_x1x2_q_2.5</code>, <code>r_y_x1x2_q_50.0</code>, and <code>r_y_x1x2_q_97.5</code> are quantiles (2.5%, 50%, and 97.5%) of the correlation between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_1X_2\)</span> when the interaction is significant.</p>
<p><code>x1_est_mean</code> and <code>x2_est_mean</code> are the mean main effects of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>, and <code>pwr_x1</code> and <code>pwr_x2</code> is the power to detect those main effects, in the context of the full interaction regression.</p>
</div>
<div class="section level3">
<h3 id="full-results">Full results<a class="anchor" aria-label="anchor" href="#full-results"></a>
</h3>
<p><code>full_results</code> can be useful when one wants a better grasp of what goes into the power analysis. If we return to our first example, we can see what range of sample-level correlations one can expect to see, given a population-level correlation:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">power_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/power_interaction.html">power_interaction</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">1000</span>,  <span class="co"># number of simulations</span>
                  alpha <span class="op">=</span> <span class="fl">0.05</span>,   <span class="co"># p-value</span>
                  N <span class="op">=</span> <span class="fl">350</span>,        <span class="co"># sample size</span>
                  r.x1.y <span class="op">=</span> <span class="fl">.2</span>,    <span class="co"># correlation between x1 and y</span>
                  r.x2.y <span class="op">=</span>  <span class="fl">.1</span>,   <span class="co"># correlation between x2 and y</span>
                  r.x1.x2 <span class="op">=</span> <span class="fl">.2</span>,   <span class="co"># correlation between x1 and x2</span>
                  r.x1x2.y <span class="op">=</span> <span class="fl">.15</span>, <span class="co"># correlation between x1x2 and y</span>
                  full_simulation <span class="op">=</span> <span class="cn">T</span>, <span class="co"># return the full simulation results       </span>
                  seed <span class="op">=</span> <span class="fl">942141</span>
                   <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "Checking for errors in inputs..."</span>
<span class="co">## [1] "Performing 1000 simulations"</span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the standard output:</span>
<span class="va">power_test</span><span class="op">$</span><span class="va">results</span></code></pre></div>
<pre><code><span class="co">##     N   pwr x1_pwr x2_pwr x1x2_est_mean x1x2_r2_mean crossover_mean shape_mean</span>
<span class="co">## 1 350 0.811  0.933  0.199     0.1637436   0.02648714     -0.3937446  0.9541953</span>
<span class="co">##   shape_q_2.5 shape_q_97.5 crossover_q_2.5 crossover_q_97.5     min.lwr</span>
<span class="co">## 1   0.4256852      2.01491       -1.158782        0.2475892 -0.08238945</span>
<span class="co">##     min.upr   max.lwr   max.upr x1x2_95_CI_2.5_mean x1x2_95_CI_97.5_mean</span>
<span class="co">## 1 0.2053328 0.1867184 0.4661274          0.06320776            0.2642794</span>
<span class="co">##   x1x2_95_CI_width_mean r_y_x1x2_q_2.5 r_y_x1x2_q_50.0 r_y_x1x2_q_97.5</span>
<span class="co">## 1             0.2010717     0.08653819       0.1645376       0.2574268</span>
<span class="co">##   x1_est_mean x2_est_mean r_x1_y_mean r_x2_y_mean r_x1_x2_mean r_y_x1x2_mean</span>
<span class="co">## 1   0.1890544  0.06119789   0.2005206  0.09941272    0.2005713     0.1664562</span>
<span class="co">##   r_x1_x1x2_mean r_x2_x1x2_mean</span>
<span class="co">## 1   -0.004301426    0.002275922</span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># range of correlations when the test is significant</span>

<span class="va">quants</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.025</span>,<span class="fl">.25</span>,<span class="fl">.5</span>,<span class="fl">.75</span>,<span class="fl">.975</span>,<span class="fl">1</span><span class="op">)</span> <span class="co">#quantiles</span>

<span class="va">power_test</span><span class="op">$</span><span class="va">simulation</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sig_int</span> <span class="op">==</span><span class="fl">1</span> <span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># only significant results</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="va">quants</span>,
                   qs <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">r_y_x1x2</span>,<span class="va">quants</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    prob         qs</span>
<span class="co">## 1 0.000 0.04975097</span>
<span class="co">## 2 0.025 0.08653819</span>
<span class="co">## 3 0.250 0.13242350</span>
<span class="co">## 4 0.500 0.16453756</span>
<span class="co">## 5 0.750 0.19639585</span>
<span class="co">## 6 0.975 0.25742682</span>
<span class="co">## 7 1.000 0.29926264</span></code></pre>
<p>When <span class="math inline">\(B_3\)</span> is significant (<code>sig_int == 1</code>), 95% of the observed sample-level correlations range from 0.1to 0.25, even though the population-level correlation is 0.15! Also note that more than half of the observed <em>significant</em> effect sizes are greater than 0.15, even though the median of <em>all</em> effects is 0.15. This is why <em>post-hoc</em> power-analyses using the observed effect-sizes in your sample are typically not a great idea. Because the choice to run the power analysis is conditioned on the result being significant, you’ve effectively subjected yourself to publication bias, and as a result the power analysis will tend to yield an inflated estimate of power.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David Baranger.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'd9b5db6cf281b0bbf8f497a463b0d116',
    indexName: 'interactionpower',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
